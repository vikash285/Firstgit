<head>
    <body>
        <h1>Appoinment Booking App</h1>
        <form onsubmit="toLocalStorage(event)">
            <input id="username" type="text" name="username" required>
            <input id="emailId" type="emial" name="emailId" required>
            <button>Submit</button>
        </form>
        <ul id="listOfUsers"></ul>
        <script>
            function toLocalStorage(event) {
                event.preventDefault();
                const name=event.target.username.value;
                const email=event.target.emailId.value;
                let obj = {
                    name,
                    email
                }
                localStorage.setItem(obj.email,JSON.stringify(obj));
                showNewUser(obj);
            }

             window.addEventListener("DOMContentLoaded",()=>{
                 const localStorageObj=localStorage;
                 const localStorageKeys=Object.keys(localStorageObj);

                 for ( var i=0;i<localStorageKeys.length;i++){
                    const key=localStorageKeys[i];
                    const userDetailsString=localStorageObj[key];
                    const userDetailsObj=JSON.parse(userDetailsString);
                    showNewUser(userDetailsObj);
                 }
             })

            function showNewUser(user){
                document.getElementById('username').value='';
                document.getElementById('emailId').value='';

                if(localStorage.getItem(user.email)!==null){
                    removeUserFromScreen(user.email);
                }

                const parentNode=document.getElementById('listOfUsers');
                const childHTML=`<li id=${user.email}> ${user.name} - ${user.email} 
                    <button onclick=editUserDetails('${user.email}','${user.name}')>Edit</button>
                    <button onclick=deleteUser('${user.email}')>Delete User</button>
                    </li>`
                parentNode.innerHTML=parentNode.innerHTML+childHTML;
            }
            function editUserDetails(emailId,name){
                document.getElementById('emailId').value=emailId;
                document.getElementById('username').value=name;

                deleteUser(emailId)
            }

            function deleteUser(emailId){
                console.log(emailId);
                localStorage.removeItem(emailId);
                removeUserFromScreen(emailId);
            }
            function removeUserFromScreen(emailId){
                
                const parentNode=document.getElementById('listOfUsers');
                const childToBeDeleted=document.getElementById(emailId);
                if(childToBeDeleted){
                    parentNode.removeChild(childToBeDeleted)
                }
            }
        </script>
    </body>
</html>