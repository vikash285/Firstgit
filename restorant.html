</head>
<body>
        <form onsubmit="signup(event)">
            <label for="name" class="form-label">Selling Price:</label>
            <input type="number" class="form-control" id="amount" name="amount" required/>
            <label for="name" class="form-label" >Product Name:</label>
            <input type="text" class="form-control" id="expense" name="expense" required/>
            <label for="categories" class="form-label">Choose a Category:</label>
            <select name="category" id="categories" class="form-control">
                <option value="Electronic">Electronic</option>
                <option value="Food">Food</option>
                <option value="Skincare">Skincare</option>
            </select>
            <button>Add Product</button>
        </form>
        <ul id="listOfUsers"><h3>Products</h3></ul>
            <ul id="Electronic"><h4>Electronic Items</h4></ul>
            <ul id="Food"><h4>Food Items</h4></ul>
            <ul id="Skincare"><h4>Skincare Items</h4></ul>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.3/axios.min.js"></script>
        <script>
            function signup(event){
                event.preventDefault();
                const amount=event.target.amount.value;
                const des=event.target.expense.value;
                const category=event.target.category.value;

                const obj={
                    amount,
                    des,
                    category
                }
                axios.post("https://crudcrud.com/api/5a1640b3fd4848cb8bd4452842c8b570/appoinmentData",obj)
                .then((res)=>{
                    showNewUserOnScreen(res.data);
                })
                .catch((err)=>{
                    console.log(err);
                })
                // localStorage.setItem(obj.des,JSON.
                // stringify(obj));
                
            }

            window.addEventListener("DOMContentLoaded",()=>{
                    axios.get("https://crudcrud.com/api/5a1640b3fd4848cb8bd4452842c8b570/appoinmentData")
                    .then((res)=>{
                        for(var i=0;i<res.data.length;i++){
                            showNewUserOnScreen(res.data[i]);
                        }
                    })
                    .catch((err)=>{
                        console.log(err);
                    })
                })

            function showNewUserOnScreen(user){
                
                document.getElementById('expense').value=''
                document.getElementById('amount').value=''
                document.getElementById('categories').value=''

                const parentNode=document.getElementById(user.category)
                const childHTML=`<li id=${user._id}> ${user.amount} - ${user.des}
                    - ${user.category} 
                    <button onclick=deleteUser('${user._id}','${user.category}')>Delete Order</button>
                    </li>`
                parentNode.innerHTML=parentNode.innerHTML+childHTML;
            }
            
            function deleteUser(del,cat){
                
                axios.delete(`https://crudcrud.com/api/5a1640b3fd4848cb8bd4452842c8b570/appoinmentData/${del}`)
                .then((res)=>{
                    removeFromScreen(del,cat)
                })
                .catch((err)=>{
                    console.log(err);
                })
                // localStorage.removeItem(del)
            }
            function removeFromScreen(del,cat){
                const parentNode=document.getElementById(cat)
                const childToBeRemoved=document.getElementById(del)
                parentNode.removeChild(childToBeRemoved)
            }
        </script>
</body>
</html>